<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formation Cybers√©curit√© : Vuln√©rabilit√©s et Bonnes Pratiques</title>
    
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            margin: 0;
            padding: 0;
            background-color: #e9eef2;
            color: #333;
        }
        header {
            background-color: #1a237e; /* Bleu fonc√© */
            color: white;
            padding: 30px 20px;
            text-align: center;
        }
        header h1 {
            margin: 0;
            font-size: 2.5em;
        }
        main {
            padding: 20px;
            max-width: 1000px;
            margin: 20px auto;
        }
        section {
            background-color: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        h2 {
            color: #0d47a1; /* Bleu clair */
            border-bottom: 3px solid #0d47a1;
            padding-bottom: 15px;
            margin-top: 0;
        }
        h3 {
            color: #d32f2f; /* Rouge pour les vuln√©rabilit√©s */
            margin-top: 25px;
        }
        .simulateur {
            border: 2px dashed #bbdefb;
            padding: 20px;
            margin: 20px 0;
            background-color: #f0f4ff;
            border-radius: 6px;
        }
        .defense {
            background-color: #e8f5e9; /* Vert tr√®s clair */
            border-left: 6px solid #4caf50; /* Vert de la solution */
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
            font-weight: bold;
        }
        .explication {
            background-color: #fbecec; /* Rouge tr√®s clair */
            border-left: 6px solid #c62828; /* Rouge du danger */
            padding: 15px;
            margin-top: 20px;
            border-radius: 4px;
        }
        #resultatSQL, .csrf-token {
            font-family: monospace;
            background-color: #333;
            color: #00ff00;
            padding: 15px;
            white-space: pre;
            border-radius: 4px;
            overflow-x: auto;
        }
        /* ... Styles d'inputs et boutons restent identiques ... */
        footer {
            text-align: center;
            padding: 20px;
            margin-top: 30px;
            color: white;
            background-color: #1a237e;
        }
    </style>
</head>
<body>
    <header>
        <h1>üõ†Ô∏è D√©fendre l'Application Web : Bonnes Pratiques</h1>
        <p>Pour chaque vuln√©rabilit√©, apprenez la bonne pratique pour y rem√©dier.</p>
    </header>

    <main>
        
        <section id="demonstration-xss">
            <h2>üß™ D√©mo 1 : La Vuln√©rabilit√© XSS (Cross-Site Scripting)</h2>
            <p>L'attaque XSS permet d'injecter du code dans le navigateur d'autres utilisateurs. Elle survient lorsque l'application ne filtre pas les entr√©es.</p>
            
            <div class="simulateur">
                <h3>Simulateur de Zone de Commentaire VULN√âRABLE</h3>
                <label for="commentaire">Entrez un texte ou un code HTML :</label>
                <input type="text" id="commentaire" placeholder="Testez : <img src=x onerror=alert('XSS_R√©ussi!')>">
                <button onclick="afficherCommentaireVulnerable()">1. Publier (Mode Dangereux)</button>
                
                <div id="zoneAffichage"><em>Contenu non s√©curis√©.</em></div>
                <button onclick="afficherCommentaireSecurise()">2. Voir la Solution S√ªre (textContent)</button>
            </div>

            <div class="defense">
                <h3>‚úÖ La D√©fense contre le XSS</h3>
                <ul>
                    <li>**Encodage des Sorties (Output Encoding) :** Toujours traiter les donn√©es utilisateur comme du **texte pur** lors de l'affichage. En JavaScript, utilisez **`element.textContent`** au lieu de `element.innerHTML`.</li>
                    <li>**Validation :** Filtrer les entr√©es pour n'accepter que les caract√®res attendus (ex: uniquement des lettres et chiffres pour un nom d'utilisateur).</li>
                </ul>
            </div>
        </section>
        
        <hr>

        <section id="demonstration-sqli">
            <h2>üí• D√©mo 4 : Injection SQL (SQLi)</h2>
            <p>L'Injection SQL permet de modifier les requ√™tes √† la base de donn√©es via les champs de saisie, permettant le vol ou la manipulation des donn√©es. C'est une vuln√©rabilit√© c√¥t√© **serveur**.</p>
            
            <div class="simulateur">
                <h3>Simulateur de Connexion VULN√âRABLE</h3>
                <label for="utilisateurSQL">Nom d'utilisateur :</label>
                <input type="text" id="utilisateurSQL" placeholder="Tentez : ' OR '1'='1">
                <button onclick="tenterConnexionSQL()">Simuler Connexion</button>
                <h4>Requ√™te SQL Ex√©cut√©e (Simul√©e) :</h4>
                <div id="resultatSQL"></div>
            </div>

            <div class="defense">
                <h3>‚úÖ La D√©fense contre la SQLi</h3>
                <ul>
                    <li>**Requ√™tes Pr√©par√©es (Prepared Statements) :** La solution **principale**. Cela s√©pare toujours la logique SQL des donn√©es utilisateurs, garantissant que les entr√©es sont toujours trait√©es comme des **donn√©es** et non comme des **instructions SQL**.</li>
                    <li>**Principe du Moindre Privil√®ge :** Les comptes utilis√©s par l'application pour acc√©der √† la base de donn√©es ne devraient avoir que les permissions minimales n√©cessaires (ex: pas le droit de supprimer ou modifier des tables sensibles).</li>
                </ul>
            </div>
        </section>
        
        <hr>

        <section id="demonstration-csrf">
            <h2>üõ°Ô∏è D√©mo 6 : Faille CSRF (Cross-Site Request Forgery)</h2>
            <p>Le navigateur envoie automatiquement le cookie de session aux sites l√©gitimes. Le CSRF exploite cette confiance pour forcer l'utilisateur √† ex√©cuter une action critique √† son insu.</p>
            
            <div class="simulateur">
                <h3>Simulateur d'Attaque CSRF (Transfert Bancaire)</h3>
                <p>URL de la banque (action critique) :</p>
                <div class="csrf-token">
                    GET https://MonCompte.com/transfert?dest=Attaquant&montant=1000
                </div>
                <button onclick="simulerAttaqueCSRF()">Simuler l'ouverture d'un site malveillant</button>
                <p id="resultatCSRF" style="margin-top: 15px;">---</p>
            </div>

            <div class="defense">
                <h3>‚úÖ La D√©fense contre le CSRF</h3>
                <ul>
                    <li>**Tokens Anti-CSRF :** Utiliser un **jeton secret** unique √† la session et √† la requ√™te. Ce jeton doit √™tre inclus dans tous les formulaires et v√©rifi√© c√¥t√© serveur. Un attaquant sur un autre site ne peut pas deviner ce jeton.</li>
                    <li>**Header `SameSite` pour les Cookies :** Configurer les cookies de session avec l'attribut `SameSite=Strict` (ou `Lax`). Le navigateur n'enverra alors pas le cookie lors de requ√™tes initi√©es par d'autres domaines (sites externes), bloquant la plupart des attaques CSRF.</li>
                </ul>
            </div>
        </section>

        <hr>

        <section id="demonstration-hashing">
            <h2>üîë D√©mo 2 : Le Hachage (Hashing) des Mots de Passe</h2>
            <p>Il ne faut jamais stocker les mots de passe en clair. Le hachage les transforme en une empreinte unique et irr√©versible.  </p>
            
            <div class="simulateur">
                </div>

            <div class="defense">
                <h3>‚úÖ La Bonne Pratique pour le Stockage des Mots de Passe</h3>
                <ul>
                    <li>**Hachage Lent et Sal√© :** Utiliser des algorithmes de hachage **lents** et sp√©cifiquement con√ßus pour les mots de passe, comme **Bcrypt** ou **Argon2**. La lenteur d√©courage les attaques par force brute sur le hash.</li>
                    <li>**Sel (Salt) Unique :** Chaque mot de passe doit √™tre hach√© avec un "sel" (valeur al√©atoire) unique. Ceci emp√™che l'utilisation de tables arc-en-ciel (*rainbow tables*).</li>
                </ul>
            </div>
        </section>

        <hr>

        <section id="demonstration-bruteforce">
            <h2>üî® D√©mo 3 : Attaque par Force Brute et D√©fense</h2>
            <p>Une attaque par force brute tente syst√©matiquement des mots de passe. Elle est facile si les tentatives ne sont pas contr√¥l√©es.</p>
            
            <div class="simulateur">
                </div>

            <div class="defense">
                <h3>‚úÖ La D√©fense contre la Force Brute</h3>
                <ul>
                    <li>**Limitation de Taux (Rate Limiting) :** Apr√®s N tentatives √©chou√©es (ex: 5), bloquer l'utilisateur ou l'adresse IP pendant une dur√©e croissante (ex: 5 minutes, puis 10 minutes).</li>
                    <li>**Verrouillage Temporaire :** Verrouiller d√©finitivement le compte apr√®s un certain nombre d'√©checs, for√ßant l'utilisateur l√©gitime √† passer par une r√©initialisation de mot de passe (si l'attaque est tr√®s cibl√©e).</li>
                    <li>**Captcha et 2FA :** Utiliser des CAPTCHA apr√®s quelques √©checs pour confirmer que l'utilisateur est humain, et encourager la **Double Authentification (2FA)**.</li>
                </ul>
            </div>
        </section>
        
        <hr>

        <section id="https-tls">
            <h2>üîí Module 5 : Le Protocole HTTPS et TLS</h2>
            <p>HTTPS chiffre la communication entre le client et le serveur. </p>
            
            <div class="defense">
                <h3>‚úÖ Bonnes Pratiques HTTPS et TLS</h3>
                <ul>
                    <li>**Utilisation Universelle :** Forcer tout le trafic √† passer par HTTPS (redirection HTTP vers HTTPS).</li>
                    <li>**HSTS (HTTP Strict Transport Security) :** Envoyer un ent√™te qui force le navigateur √† n'utiliser que HTTPS pour ce site, m√™me lors de la saisie manuelle de l'URL.</li>
                    <li>**Mise √† Jour des Certificats :** S'assurer que les certificats TLS sont valides et que seules les versions r√©centes et s√©curis√©es du protocole TLS (TLS 1.2 ou 1.3) sont utilis√©es, en d√©sactivant les anciennes versions (SSL 3.0, TLS 1.0/1.1).</li>
                </ul>
            </div>
        </section>

    </main>
    
    <footer>
        <p>&copy; 2025 Formation Cybers√©curit√© - La s√©curit√© est l'affaire de tous.</p>
    </footer>

    <script>
        // Le code JavaScript complet des six modules est ins√©r√© ici
        // (Pour des raisons de concision, je n'ins√®re que les nouvelles fonctions JS ici, 
        // mais le code final doit contenir toutes les fonctions JS des modules 1 √† 6).

        // JS des D√©mos 1 √† 6 (y compris les nouvelles fonctions):

        // D√âMO 1 : XSS
        function afficherCommentaireVulnerable() {
            const input = document.getElementById('commentaire').value;
            const zoneAffichage = document.getElementById('zoneAffichage');
            zoneAffichage.innerHTML = '<p style="color:red;">Commentaire VULN√âRABLE :</p>' + input; 
            if (input.includes('alert(')) {
                alert("Code XSS Ex√©cut√© ! Danger d'utiliser innerHTML.");
            }
        }
        function afficherCommentaireSecurise() {
            const input = document.getElementById('commentaire').value;
            const zoneAffichage = document.getElementById('zoneAffichage');
            zoneAffichage.textContent = 'Commentaire S√âCURIS√â : ' + input;
            alert("Code malveillant trait√© comme du texte. Vuln√©rabilit√© √©vit√©e gr√¢ce √† textContent.");
        }

        // D√âMO 4 : SQLi
        function tenterConnexionSQL() {
            const userInput = document.getElementById('utilisateurSQL').value;
            const resultatSQL = document.getElementById('resultatSQL');
            const requeteVulnerable = "SELECT * FROM utilisateurs WHERE nom='" + userInput + "' AND mot_de_passe='quelconque';";
            
            resultatSQL.textContent = requeteVulnerable;

            if (userInput.includes("' OR '1'='1")) {
                resultatSQL.textContent += "\n\n--> RESULTAT DU SERVEUR :\nConnexion r√©ussie ! (Utilisateur ADMIN)\n\nEXPLICATION : L'ajout de ' OR '1'='1 a rendu la condition logique toujours VRAIE.";
                resultatSQL.style.backgroundColor = '#cc0000';
                resultatSQL.style.color = 'white';
            } else {
                resultatSQL.style.backgroundColor = '#333';
                resultatSQL.style.color = '#00ff00';
                resultatSQL.textContent += "\n\n--> RESULTAT DU SERVEUR :\n√âchec de la connexion (Nom d'utilisateur non trouv√©).";
            }
        }

        // D√âMO 6 : CSRF
        function simulerAttaqueCSRF() {
            const resultatCSRF = document.getElementById('resultatCSRF');
            
            resultatCSRF.innerHTML = 'üî¥ **SIMULATION R√âUSSIE** : Le navigateur a tent√© de charger l\'attaque.<br>Puisque votre cookie de session √©tait pr√©sent, le serveur VULN√âRABLE aurait ex√©cut√© l\'action.';
            resultatCSRF.style.color = '#c62828';
        }
        
        // D√âMO 2 : Hachage
        function hacherMotDePasse() {
            const mdp = document.getElementById('mdpClair').value;
            const resultatHachage = document.getElementById('resultatHachage');
            
            if (mdp.length === 0) {
                resultatHachage.textContent = 'Entrez un mot de passe √† hacher.';
                return;
            }
            
            const salt = Math.random().toString(36).substring(2, 7);
            const encoded = btoa(mdp + salt); 
            const hashSimule = '$BCRYPT$' + salt + '$' + encoded.slice(0, 40).toUpperCase();
            
            resultatHachage.textContent = hashSimule;
        }
        
        // D√âMO 3 : Force Brute
        let tentativesRestantes = 5;
        const mdpCible = '123456'; 
        const elementTentatives = document.getElementById('tentativesRestantes');
        const elementResultat = document.getElementById('resultatBruteForce');

        function tenterConnexion() {
            const mdpEntre = document.getElementById('mdpAttaque').value;

            if (tentativesRestantes <= 0) {
                elementResultat.innerHTML = '‚õî **COMPTE BLOQU√â !** D√©fense par Limitation de Taux activ√©e.';
                return;
            }

            if (mdpEntre === mdpCible) {
                elementResultat.innerHTML = '‚úÖ **SUCC√àS !** Mot de passe trouv√© : ' + mdpCible + '.';
                tentativesRestantes = 5; 
                elementTentatives.textContent = 5;
            } else {
                tentativesRestantes--;
                elementTentatives.textContent = tentativesRestantes;
                
                if (tentativesRestantes > 0) {
                    elementResultat.textContent = '‚ùå √âchec de la connexion. Il vous reste ' + tentativesRestantes + ' tentatives.';
                } else {
                    elementResultat.innerHTML = '‚õî **COMPTE BLOQU√â !** Le Rate Limiting a stopp√© l\'attaque.';
                }
            }
        }
    </script>
</body>
</html>
